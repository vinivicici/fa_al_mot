## 📝 개요
이 프로젝트는 이미지 임베딩을 포함한 상품 데이터를 사용하여 세 가지 기본적인 머신러닝 작업을 시연합니다: **클러스터링(Clustering)**, **분류(Classification)**, **회귀(Regression)**.

스크립트들은 모듈식으로 설계되었으며, 중앙 `data_loader.py` 파일이 각 작업에 필요한 데이터를 준비하고 제공하는 구조를 가집니다.

이 프로젝트의 주요 목표는 다음을 위한 명확하고 실행 가능한 프레임워크를 제공하는 것입니다:

- 상품의 시각적 유사성에 기반한 그룹화 (클러스터링)
- 상품의 스타일 카테고리 예측 (분류)
- 상품의 가격 예측 (회귀)

---

## 📁 파일 구조
├── data_loader.py       # Parquet 파일에서 데이터셋을 로드하고 분할합니다.
├── clustering.py        # 이미지 임베딩에 대한 비지도 클러스터링을 수행합니다.
├── classification.py    # 다양한 분류 모델을 사용해 상품 'style'을 예측합니다.
├── regression.py        # 다양한 회귀 모델을 사용해 상품 'price'를 예측합니다.

## ⚙️ 설정 및 사용법
### 1. 필요 라이브러리 설치
먼저, 필요한 파이썬 라이브러리가 설치되어 있는지 확인하세요.
```bash
pip install pandas numpy scikit-learn matplotlib seaborn pyarrow
(참고: pyarrow는 pandas에서 Parquet 파일을 읽기 위해 필요합니다.)
### 2. 데이터 준비
스크립트를 실행하기 전, 반드시 데이터셋 경로를 지정해야 합니다.
1. 프로젝트 디렉토리에 데이터셋(예: products.parquet)을 위치시킵니다.
2. data_loader.py 파일을 엽니다.
3. 'YOUR_FILE_PATH.parquet' 부분을 실제 데이터 파일명으로 수정합니다.

### 3. 스크립트 실행
터미널에서 원하는 머신러닝 작업 스크립트를 실행합니다.
클러스터링 작업을 실행하려면:
```bash
python clustering.py
분류 작업을 실행하려면:
```bash
python classification.py
회귀 작업을 실행하려면:
```bash
python regression.py

### **3. 모델과 평가지표 (전체)**
### 1. 클러스터링 (clustering.py)
`image_embedding_vector`의 유사성을 기반으로 상품을 그룹화하는 비지도 학습을 수행합니다.

- **전처리**:
    - **주성분 분석(PCA)**을 사용하여 고차원 임베딩 벡터를 2차원으로 축소합니다. 이는 **시각화 목적**으로만 사용됩니다.
    - 실제 클러스터링 알고리즘은 최대한의 정보를 유지하기 위해 원본 고차원 데이터로 학습됩니다.

- **사용 모델**:
    - **비계층적**: K-Means, K-Means++
    - **계층적**: 병합 군집 (Agglomerative Clustering) ('single', 'complete', 'average', 'ward' 연결 방식 사용)

- **평가 지표**:
    - **실루엣 점수 (Silhouette Score)**: 데이터 포인트가 자신의 클러스터에 얼마나 잘 속해 있는지를 다른 클러스터와 비교하여 측정합니다. -1에서 1 사이의 값을 가지며, 높은 값일수록 해당 객체가 자신의 클러스터와 잘 맞고 이웃 클러스터와는 잘 맞지 않음을 의미합니다.

- **결과물**:
    - 각 모델의 실루엣 점수가 콘솔에 출력됩니다.
    - 각 모델의 클러스터 할당 결과를 시각화하는 2D 산점도가 생성됩니다.

### 2. 분류 (classification.py)
상품의 카테고리인 `style`을 예측하기 위해 지도 학습 모델을 훈련합니다.

- **전처리**:
    - **벡터 확장**: 리스트/배열 형태인 `image_embedding_vector` 컬럼을 각 원소가 별개의 피처 컬럼(예: `embed_0`, `embed_1`, ...)이 되도록 확장합니다.
    - 이 과정을 통해 임베딩에 담긴 풍부한 시각적 정보를 표준 분류 모델이 이해할 수 있는 형태로 변환합니다.

- **사용 모델**:
    - 결정 트리 (Decision Tree) ('gini', 'entropy' 기준 사용)
    - 랜덤 포레스트 (Random Forest)
    - 에이다부스트 (AdaBoost)

- **평가 지표**:
    - **정확도 (Accuracy)**: 전체 예측 중 올바르게 예측한 비율.
    - **정밀도 (Precision - Macro)**: 모델이 positive로 예측한 것 중 실제 positive인 것의 비율.
    - **재현율 (Recall - Macro)**: 실제 positive인 것 중 모델이 positive로 예측한 것의 비율.
    - **F1-점수 (F1-Score - Macro)**: 정밀도와 재현율의 조화 평균.

- **결과물**:
    - 각 모델에 대한 위 지표들이 포함된 리포트가 출력됩니다.
    - 클래스별 정답 및 오답 분포를 보여주는 **혼동 행렬(Confusion Matrix)** 시각화가 각 모델에 대해 생성됩니다.

### 3. 회귀 (regression.py)
연속적인 값인 상품의 `price`를 예측하기 위해 지도 학습 모델을 훈련합니다.

- **전처리**:
    - **벡터 확장**: 분류 스크립트와 동일하게, `image_embedding_vector`를 개별 피처들로 펼칩니다.

- **사용 모델**:
    - 선형 회귀 (Linear Regression)
    - 릿지 회귀 (Ridge Regression - L2 규제)
    - 라쏘 회귀 (Lasso Regression - L1 규제)
    - 랜덤 포레스트 회귀 (Random Forest Regressor)
    - K-최근접 이웃 회귀 (K-Neighbors Regressor)

- **평가 지표**:
    - **R² (결정계수)**: 독립 변수가 종속 변수의 분산을 얼마나 잘 설명하는지를 나타내는 지표. 1에 가까울수록 완벽한 예측을 의미합니다.
    - **MSE (평균제곱오차)**: 실제값과 예측값의 차이를 제곱하여 평균 낸 값. 낮을수록 좋습니다.
    - **RMSE (평균제곱근오차)**: MSE에 제곱근을 취한 값으로, 실제값과 동일한 단위를 가져 해석이 더 직관적입니다. 낮을수록 좋습니다.

- **결과물**:
    - 각 모델에 대한 R², MSE, RMSE 지표가 포함된 리포트가 출력됩니다.
    - 성능을 시각적으로 평가하기 위해 각 모델의 **실제 가격 vs. 예측 가격 산점도**가 생성됩니다.
